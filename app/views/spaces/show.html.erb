<p id="notice"><%# notice %></p>
<h3><%="#{@space.space_name }"%></h3>
<h5>User = <%="#{@user_id}"%></h5>

<div class="container-fluid">
  <div class="row">

    <div class="col-md-8">
      <% @space.images.order('id ASC').each do |image| %>
      <img src="<%= image.url %>" alt="" class="profileImg" />
      <% end %>
    </div>

    <div>
      <h4>Shoutout</h4>
      <% @space.shouts.order('id DESC').each do |shout| %>
        <p>
          <%= shout.message %><br/>
          by <a href="/users/<%= shout.user.id %>/"><%= shout.user.first_name %></a>
          <% if shout.user_id == @user_id%>
          <%= link_to 'Edit', edit_shout_path(shout) %>
          <%= link_to 'Delete', shout, method: :delete, data: { confirm: 'Are you sure?' } %>
          <% end %>
        </p>
      <% end %>
    </div>

    <% if @current_user %>
          <%= form_for @shout do |f| %>
            <input type="hidden" name="shout[user_id]" value="<%= @user_id%>">
            <input type="hidden" name="shout[space_id]" value="<%= params[:id] %>">
            <div class="field">
            <%= f.text_area :message %>
            </div>
            <div class="actions">
              <%= f.submit %>
            </div>
          <% end %>
    <% else %>
      <p>
        <a href="/login">Login</a> to give a shoutout to your favourite space!
      </p>
    <% end %>
  </div>
</div>

<div class="container-fluid">
  <div class="row">
    <div class="col-lg-12">
      <h4>Details</h4>
      <p>
        <strong>Country:</strong>
        <%= @space.country.name %></br>

        <strong>Area:</strong>
        <%= @space.area.name %></br>

        <strong>Address:</strong>
        <%= @space.address %></br>


        <strong>Postal:</strong>
        <%= @space.postal %></br>


        <strong>Space description:</strong>
        <%= @space.space_description %></br>


        <strong>Space type:</strong>
        <%= @space.space_type.name %></br>


        <strong>Vibe:</strong>
        <%= @space.vibe.name %></br>

        <strong>Email:</strong>
        <%= @space.user.email %></br>
      </p>
        </div>
      </div>
    </div>

<div class="container-fluid">
  <div class="row">
    <h4 id='avail_head'>Availabilities</h4>
    <%if @user_id == @space_owner%>
      <%= link_to 'New', new_availability_path(space_id: @space.id), :role => 'button', :class => "btn btn-outline-primary btn-sm"  %>
    <%end%>

    <table>
        <tr>
          <th>Start</th>
          <th>End</th>
          <th>Seat</th>
          <th>Seat price</th>
          <th colspan="3"></th>
        </tr>
      <tbody>
        <% @availabilities.order(start: :asc).each do |availability| %>
          <tr>
            <td><%= availability.start.strftime("%d-%b-%Y") %></td>
            <td><%= availability.end.strftime("%d-%b-%Y") %></td>
            <td><%= availability.seat %></td>
            <td><%= availability.seat_price %></td>
              <%if @user_id == 'public' %>
                <td><%=link_to 'Log In to Book', login_path%></td>
              <%elsif @user_id!= @space_owner%>
                <td><%= link_to 'Book', new_booking_path(avail_id: availability.id, space_id: availability.space_id)%></td>
              <%end%>
            <%if @user_id== @space_owner%>
              <td><%= link_to 'Edit', edit_availability_path(availability) %></td>
              <td><%= link_to 'Delete', availability, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            <%end%>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<%if @user_id== @space_owner%>
  <%= link_to 'Edit', edit_space_path(@space) %> |
<%end%>
<%= link_to 'Back', spaces_path %>
<%= link_to 'Logout', logout_path, method: :delete %>
